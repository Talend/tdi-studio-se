<%@ jet 
%>

<%if(enableKMS){ /* KMS is enabled, so test for default or presence of key */
%>
	<%
	if(isLog4jEnabled){
	%>	
		log.info("<%=cid%> - KMS-Enabled - kmsid="+<%=kmsid%>);
	<%
	}
	%>
	<%
	if("\"\"".equals(kmsid)){
	%>
		<%
		if(isLog4jEnabled){
		%>	
			log.info("<%=cid%> - No KMS key - use default");
		<%
		}
		%>
		putRequest_<%=cid%>.setSSEAwsKeyManagementParams(new com.amazonaws.services.s3.model.SSEAwsKeyManagementParams ());
	<%
	} else {
	%>
		<%
		if(isLog4jEnabled){
		%>	
			log.info("<%=cid%> - Key found - use key");
		<%
		}
		%>
		putRequest_<%=cid%>.setSSEAwsKeyManagementParams(new com.amazonaws.services.s3.model.SSEAwsKeyManagementParams (<%=kmsid%>));
	<%
	}
	%>
<%
}
%>

<%
if(enableObjectLock) {
	if("GOVERNANCE".equals(retentionMode)) {
%>
		putRequest_<%=cid%>.withObjectLockMode(com.amazonaws.services.s3.model.ObjectLockMode.GOVERNANCE).withObjectLockRetainUntilDate(new java.util.Date(Long.parseLong("<%=millisecTime %>")));
<%		
	} else if("COMPLIANCE".equals(retentionMode)) {
%>
		putRequest_<%=cid%>.withObjectLockMode(com.amazonaws.services.s3.model.ObjectLockMode.COMPLIANCE).withObjectLockRetainUntilDate(new java.util.Date(Long.parseLong("<%=millisecTime %>")));
<%
	}
}
%>